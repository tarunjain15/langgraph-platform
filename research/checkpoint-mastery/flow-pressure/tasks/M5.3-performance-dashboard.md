```yaml
task_id: M5.3
phase: M5
type: Monitoring
status: pending
created: 2025-11-17
```

# Task 5.3: [Monitoring] Performance Dashboard

## The Constraint

**Before:** PostgreSQL metrics scattered â†’ no single pane of glass
**After:** Grafana dashboard showing write/read latency, connection pool, error rates

---

## The Witness

**Observable Truth:** Dashboard displays 6 key metrics: write latency, read latency, connection pool usage, error rate, throughput, database size

---

## Acceptance Criteria

- [ ] Grafana dashboard created with 6 panels
- [ ] Metrics updating in real-time (<1 minute lag)
- [ ] Historical data visible (7 day retention)
- [ ] Alerts configured for anomalies

---

## Code Pattern

```yaml
# Grafana Dashboard JSON (key panels)
panels:
  - title: "Checkpoint Write Latency (P99)"
    query: histogram_quantile(0.99, rate(checkpoint_write_duration_seconds_bucket[5m]))

  - title: "Checkpoint Read Latency (P99)"
    query: histogram_quantile(0.99, rate(checkpoint_read_duration_seconds_bucket[5m]))

  - title: "Connection Pool Usage"
    query: pg_stat_database_numbackends / pg_settings_max_connections * 100

  - title: "Error Rate"
    query: rate(checkpoint_writes_total{status="error"}[5m]) / rate(checkpoint_writes_total[5m]) * 100

  - title: "Throughput (writes/sec)"
    query: rate(checkpoint_writes_total[1m])

  - title: "Database Size"
    query: pg_database_size_bytes{datname="checkpoints"}
```

---

## The Completion Signal

**Signal:** Dashboard showing all 6 metrics with real-time updates

**Evidence:** Dashboard screenshot, metric queries verified

---

## Notes

**Single Pane:** One dashboard for all PostgreSQL health metrics. No hunting across tools.
