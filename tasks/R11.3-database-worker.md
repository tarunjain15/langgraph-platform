```yaml
task_id: R11.3
phase: R11
type: Feature
status: complete
created: 2025-11-24
completed: 2025-11-24
witness_verified: true
database_worker_lines: 630
void_delete_simulation: 2_rows_predicted_0_deleted
execute_insert_duration: 1.53ms
execute_delete_duration: 2_rows_deleted
```

# Task R11.3: [Feature] DatabaseWorker Implementation

## The Constraint

**Before:** Direct SQL in workflows
**After:** DatabaseWorker wraps database operations via 7-tool interface

## The Witness

**Observable Truth:** `db_worker.void({"action": "delete"})` shows affected rows WITHOUT actual deletion

## Acceptance Criteria

- [x] DatabaseWorker implements Worker interface (workers/database_worker.py, 630 lines)
- [x] state() returns connection status, table list (tested: connected=True, table_count=2)
- [x] constraints() returns database policies (e.g., "no_drop_tables", "read_only_prod") (environment-dependent constraints)
- [x] execute({"action": "insert"}) performs actual INSERT (tested: row_id=7, duration=1.53ms)
- [x] void({"action": "delete"}) simulates DELETE, returns affected_rows, NO actual deletion (tested: affected_rows=2, side_effect=False)

## Code Pattern

```python
class DatabaseWorker:
    async def state(self) -> dict:
        return {
            "connected": self.conn.is_connected(),
            "table_count": len(self.get_tables()),
            "environment": "production"
        }

    async def constraints(self) -> list:
        if self.environment == "production":
            return ["no_drop_tables", "read_only"]
        return []

    async def void(self, action: dict) -> dict:
        if action["type"] == "delete":
            # Simulate with COUNT query
            count = self.conn.execute(f"SELECT COUNT(*) FROM {action['table']} WHERE {action['where']}").fetchone()[0]
            return {"affected_rows": count, "side_effect": False}
```

## Completion Signal

DatabaseWorker.void() simulates DELETE showing affected rows without actual deletion

## Notes

void() critical for production safety - preview impact before executing
